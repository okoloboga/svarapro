bind 0.0.0.0
port 6379
timeout 0
tcp-keepalive 300

daemonize no
loglevel notice
databases 16

# RDB off (исключаем BGSAVE), оставляем только AOF
save ""

appendonly yes
appendfilename "appendonly.aof"
appendfsync everysec
no-appendfsync-on-rewrite yes
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb

# Память — подберите под сервер
maxmemory 512mb
maxmemory-policy allkeys-lru
maxmemory-samples 5

# Клиенты
maxclients 10000
tcp-backlog 511

# Мониторинг задержек
latency-monitor-threshold 100

# Логи
slowlog-log-slower-than 10000
slowlog-max-len 128

# Совместимые опции для Redis 7+ (без ziplist/slave)
activerehashing yes
hz 10
aof-rewrite-incremental-fsync yes